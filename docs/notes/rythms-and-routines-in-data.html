<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Henrik Korsgaard - Rythms and Routines in Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script type="module" src="../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">


<link rel="stylesheet" href="../css/styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../" class="navbar-brand navbar-brand-logo">
    <img src="../public/images/henrik-transparent.png" alt="" class="navbar-logo">
    </a>
  </div>
          <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../notes.html">
 <span class="menu-text">NOTES</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../things.html">
 <span class="menu-text">THINGS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../research.html">
 <span class="menu-text">RESEARCH</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html">
 <span class="menu-text">ABOUT</span></a>
  </li>  
</ul>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Rythms and Routines in Data</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Data reflects the world and systems that generates it. A lot of the patterns that can be identified using various analytic methods are not surprising, but quite obvious if looking to the practices producing the data. In many ways, it makes more sense to talk about rythms and routines when considering patterns in data. The patterns are weak or strong signals, or residue or traces of the people and practices, and not isolated patterns only visible in the data. A lot can be revealed from observing, engaging with, participating in and reflecting on a given practice in parallel with analysing the data it produces.</p>
<p><strong>Lets dive into some data and look at some patterns to examplify what I mean with rythms and routines in relation to data.</strong></p>
<section id="data-on-electricity-consumption" class="level2">
<h2 class="anchored" data-anchor-id="data-on-electricity-consumption">Data on electricity consumption</h2>
<p>In Denmark anyone can download data on their electricity consumption from <a href="https://eloverblik.dk/welcome">El Overblik</a>. You can download data for your household meter with a resolution from year, over month and day, to hour and even every 15 minutes in some cases. We start with a dataset over my households electricity consumption since November 2017 per month. Some wrangling is required to reduce object and format the data.</p>
<div class="cell" data-output="all">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1" data-startfrom="16" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 15;"><span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">// Loading our data file</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>months <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"/public/data/el-consumption-months-all.csv"</span>)<span class="op">.</span><span class="fu">csv</span>({<span class="dt">typed</span><span class="op">:</span><span class="kw">true</span>})<span class="op">.</span><span class="fu">then</span>(raw <span class="kw">=&gt;</span> {</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">//We want to simplify our objects and translate the values into appropriate formats.</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">//We keep the date and the value</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    raw <span class="op">=</span> raw<span class="op">.</span><span class="fu">filter</span>(o <span class="kw">=&gt;</span> {</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> str <span class="op">=</span> o[<span class="st">"Fra_dato"</span>]<span class="op">.</span><span class="fu">substring</span>(<span class="dv">6</span><span class="op">,</span><span class="dv">10</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> o[<span class="st">"Type"</span>] <span class="op">===</span> <span class="st">"Tidsserie"</span> <span class="op">&amp;&amp;</span> str <span class="op">!=</span> <span class="st">"2017"</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    raw <span class="op">=</span> raw<span class="op">.</span><span class="fu">map</span>(o <span class="kw">=&gt;</span> {</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>            <span class="kw">var</span> d_str <span class="op">=</span> o[<span class="st">"Fra_dato"</span>]<span class="op">.</span><span class="fu">replace</span>(<span class="st">" 00:00:00"</span><span class="op">,</span> <span class="st">""</span>)<span class="op">.</span><span class="fu">split</span>(<span class="st">"-"</span>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>            <span class="kw">var</span> d <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(d_str[<span class="dv">2</span>]<span class="op">,</span><span class="pp">parseInt</span>(d_str[<span class="dv">1</span>])<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>            <span class="kw">var</span> v <span class="op">=</span> <span class="kw">typeof</span> o[<span class="st">"Mængde"</span>] <span class="op">==</span> <span class="st">"string"</span> <span class="op">?</span> <span class="pp">parseInt</span>(o[<span class="st">"Mængde"</span>]) <span class="op">:</span> o[<span class="st">"Mængde"</span>]</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>            <span class="co">// We add a couple of things. The fakedate allow us to place all the values in the same year (to wrangle )</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> {<span class="dt">date</span><span class="op">:</span> d<span class="op">,</span> <span class="dt">kwhs</span><span class="op">:</span> <span class="pp">parseInt</span>(o[<span class="st">"Mængde"</span>])<span class="op">,</span> <span class="dt">year</span><span class="op">:</span> d<span class="op">.</span><span class="fu">getFullYear</span>()<span class="op">,</span> <span class="dt">month</span><span class="op">:</span>d<span class="op">.</span><span class="fu">getMonth</span>()<span class="op">,</span> <span class="dt">fakedate</span><span class="op">:</span> <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2022</span><span class="op">,</span>d<span class="op">.</span><span class="fu">getMonth</span>())}</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> raw<span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span>b) <span class="kw">=&gt;</span> {</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> a[<span class="st">"date"</span>] <span class="op">&gt;</span> b[<span class="st">"date"</span>]</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-1" data-nodetype="declaration">

</div>
</div>
</div>
<p>Now that we have some data, we can start to look at some patterns.</p>
</section>
<section id="rythms-in-data" class="level2">
<h2 class="anchored" data-anchor-id="rythms-in-data">Rythms in Data</h2>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2" data-startfrom="42" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 41;"><span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span><span class="dv">860</span><span class="op">,</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>    <span class="dt">height</span><span class="op">:</span><span class="dv">400</span><span class="op">,</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>    <span class="dt">legend</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> {</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>        <span class="dt">ticks</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>        <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>        <span class="dt">label</span><span class="op">:</span> <span class="st">"Months"</span><span class="op">,</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>        <span class="dt">domain</span><span class="op">:</span> [months[<span class="dv">0</span>][<span class="st">"date"</span>]<span class="op">,</span>months[months<span class="op">.</span><span class="at">length</span><span class="op">-</span><span class="dv">1</span>][<span class="st">"date"</span>]]</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>        <span class="dt">label</span><span class="op">:</span> <span class="st">"Consumption (kwhs)"</span><span class="op">,</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>        <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>        <span class="dt">domain</span><span class="op">:</span> [<span class="dv">200</span><span class="op">,</span> <span class="dv">550</span>]</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>    <span class="dt">caption</span><span class="op">:</span> <span class="fu">html</span><span class="vs">`Figure 1. Household electricity consumption (kilowatt hours) from 2018 to 2022`</span><span class="op">,</span></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">line</span>(months<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"date"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"kwhs"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"darkblue"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">curve</span><span class="op">:</span> <span class="st">"natural"</span>})<span class="op">,</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-2" data-nodetype="expression">

</div>
</div>
</div>
<p>Hard to see patterns at this level. What happens if we plot each year on an individual line?</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3" data-startfrom="69" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 68;"><span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span><span class="dv">860</span><span class="op">,</span></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>    <span class="dt">height</span><span class="op">:</span><span class="dv">400</span><span class="op">,</span></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>    <span class="dt">color</span><span class="op">:</span> {</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> <span class="st">"categorical"</span><span class="op">,</span></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>        <span class="dt">scheme</span><span class="op">:</span> <span class="st">"Dark2"</span><span class="op">,</span></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>        <span class="dt">legend</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> {</span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>        <span class="dt">ticks</span><span class="op">:</span> <span class="dv">12</span><span class="op">,</span></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>        <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>        <span class="dt">label</span><span class="op">:</span> <span class="st">"Months"</span><span class="op">,</span></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> <span class="st">"time"</span><span class="op">,</span></span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>        <span class="dt">tickFormat</span><span class="op">:</span> <span class="st">"%B"</span><span class="op">,</span></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>        <span class="dt">domain</span><span class="op">:</span> [<span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2022</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span>)<span class="op">,</span><span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2022</span><span class="op">,</span><span class="dv">11</span><span class="op">,</span><span class="dv">1</span>)]</span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>        <span class="dt">label</span><span class="op">:</span> <span class="st">"Consumption (kwhs)"</span><span class="op">,</span></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>        <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>        <span class="dt">domain</span><span class="op">:</span> [<span class="dv">200</span><span class="op">,</span> <span class="dv">550</span>]</span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>    <span class="dt">caption</span><span class="op">:</span> <span class="fu">html</span><span class="vs">`Figure 2. Household electricity consumption (kilowatt hours) with line for each year.`</span><span class="op">,</span></span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">line</span>(months<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span> <span class="op">==</span> <span class="dv">2018</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"fakedate"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"kwhs"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">curve</span><span class="op">:</span> <span class="st">"natural"</span>})<span class="op">,</span></span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">line</span>(months<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span> <span class="op">==</span> <span class="dv">2019</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"fakedate"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"kwhs"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">curve</span><span class="op">:</span> <span class="st">"natural"</span>})<span class="op">,</span></span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">line</span>(months<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span> <span class="op">==</span> <span class="dv">2020</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"fakedate"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"kwhs"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">curve</span><span class="op">:</span> <span class="st">"natural"</span>})<span class="op">,</span></span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">line</span>(months<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span> <span class="op">==</span> <span class="dv">2021</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"fakedate"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"kwhs"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">curve</span><span class="op">:</span> <span class="st">"natural"</span>})<span class="op">,</span></span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">line</span>(months<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span> <span class="op">==</span> <span class="dv">2022</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"fakedate"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"kwhs"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">curve</span><span class="op">:</span> <span class="st">"natural"</span>})</span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-3" data-nodetype="expression">

</div>
</div>
</div>
<p>By overlaying the years we notice some trends. First, all the lines move downward on the left side of the graph and upward on the right side of the graph. Second, around March and April, between May and June, and again around September and October the lines seem to follow a pattern.</p>
<p><strong>Let’s change resolution from months to days and see what we get.</strong></p>
<div class="cell" data-output="all">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4" data-startfrom="110" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 109;"><span id="cb4-110"><a href="#cb4-110" aria-hidden="true" tabindex="-1"></a><span class="co">// Loading our data file</span></span>
<span id="cb4-111"><a href="#cb4-111" aria-hidden="true" tabindex="-1"></a>days <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"/public/data/el-consumption-days-all.csv"</span>)<span class="op">.</span><span class="fu">csv</span>({<span class="dt">typed</span><span class="op">:</span><span class="kw">true</span>})<span class="op">.</span><span class="fu">then</span>(raw <span class="kw">=&gt;</span> {</span>
<span id="cb4-112"><a href="#cb4-112" aria-hidden="true" tabindex="-1"></a>    <span class="co">//We want to simplify our objects and translate the values into appropriate formats.</span></span>
<span id="cb4-113"><a href="#cb4-113" aria-hidden="true" tabindex="-1"></a>    <span class="co">//We keep the date and the value</span></span>
<span id="cb4-114"><a href="#cb4-114" aria-hidden="true" tabindex="-1"></a>    raw <span class="op">=</span> raw<span class="op">.</span><span class="fu">filter</span>(o <span class="kw">=&gt;</span> {</span>
<span id="cb4-115"><a href="#cb4-115" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> str <span class="op">=</span> o[<span class="st">"Fra_dato"</span>]<span class="op">.</span><span class="fu">substring</span>(<span class="dv">6</span><span class="op">,</span><span class="dv">10</span>)</span>
<span id="cb4-116"><a href="#cb4-116" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> o[<span class="st">"Type"</span>] <span class="op">===</span> <span class="st">"Tidsserie"</span> <span class="op">&amp;&amp;</span> str <span class="op">!=</span> <span class="st">"2017"</span></span>
<span id="cb4-117"><a href="#cb4-117" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb4-118"><a href="#cb4-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-119"><a href="#cb4-119" aria-hidden="true" tabindex="-1"></a>    raw <span class="op">=</span> raw<span class="op">.</span><span class="fu">map</span>(o <span class="kw">=&gt;</span> {</span>
<span id="cb4-120"><a href="#cb4-120" aria-hidden="true" tabindex="-1"></a>            <span class="kw">var</span> d_str <span class="op">=</span> o[<span class="st">"Fra_dato"</span>]<span class="op">.</span><span class="fu">replace</span>(<span class="st">" 00:00:00"</span><span class="op">,</span> <span class="st">""</span>)<span class="op">.</span><span class="fu">split</span>(<span class="st">"-"</span>)</span>
<span id="cb4-121"><a href="#cb4-121" aria-hidden="true" tabindex="-1"></a>            <span class="kw">var</span> d <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(d_str[<span class="dv">2</span>]<span class="op">,</span><span class="pp">parseInt</span>(d_str[<span class="dv">1</span>])<span class="op">-</span><span class="dv">1</span><span class="op">,</span> d_str[<span class="dv">0</span>])</span>
<span id="cb4-122"><a href="#cb4-122" aria-hidden="true" tabindex="-1"></a>            <span class="kw">var</span> f <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2022</span><span class="op">,</span><span class="pp">parseInt</span>(d_str[<span class="dv">1</span>])<span class="op">-</span><span class="dv">1</span><span class="op">,</span> d_str[<span class="dv">0</span>])</span>
<span id="cb4-123"><a href="#cb4-123" aria-hidden="true" tabindex="-1"></a>            <span class="kw">var</span> v <span class="op">=</span> <span class="kw">typeof</span> o[<span class="st">"Mængde"</span>] <span class="op">==</span> <span class="st">"string"</span> <span class="op">?</span> <span class="pp">parseInt</span>(o[<span class="st">"Mængde"</span>]) <span class="op">:</span> o[<span class="st">"Mængde"</span>]</span>
<span id="cb4-124"><a href="#cb4-124" aria-hidden="true" tabindex="-1"></a>            <span class="co">// We add a couple of things. The fakedate allow us to place all the values in the same year (to wrangle )</span></span>
<span id="cb4-125"><a href="#cb4-125" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> {<span class="dt">date</span><span class="op">:</span> d<span class="op">,</span> <span class="dt">kwhs</span><span class="op">:</span> <span class="pp">parseInt</span>(o[<span class="st">"Mængde"</span>])<span class="op">,</span> <span class="dt">year</span><span class="op">:</span> d<span class="op">.</span><span class="fu">getFullYear</span>()<span class="op">,</span> <span class="dt">month</span><span class="op">:</span>d<span class="op">.</span><span class="fu">getMonth</span>()<span class="op">,</span> <span class="dt">fakedate</span><span class="op">:</span> f}</span>
<span id="cb4-126"><a href="#cb4-126" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb4-127"><a href="#cb4-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-128"><a href="#cb4-128" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> raw<span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span>b) <span class="kw">=&gt;</span> {</span>
<span id="cb4-129"><a href="#cb4-129" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> a[<span class="st">"date"</span>] <span class="op">&gt;</span> b[<span class="st">"date"</span>]</span>
<span id="cb4-130"><a href="#cb4-130" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb4-131"><a href="#cb4-131" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5" data-startfrom="135" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 134;"><span id="cb5-135"><a href="#cb5-135" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb5-136"><a href="#cb5-136" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span><span class="dv">860</span><span class="op">,</span></span>
<span id="cb5-137"><a href="#cb5-137" aria-hidden="true" tabindex="-1"></a>    <span class="dt">height</span><span class="op">:</span><span class="dv">400</span><span class="op">,</span></span>
<span id="cb5-138"><a href="#cb5-138" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span></span>
<span id="cb5-139"><a href="#cb5-139" aria-hidden="true" tabindex="-1"></a>    <span class="dt">color</span><span class="op">:</span> {</span>
<span id="cb5-140"><a href="#cb5-140" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> <span class="st">"categorical"</span><span class="op">,</span></span>
<span id="cb5-141"><a href="#cb5-141" aria-hidden="true" tabindex="-1"></a>        <span class="dt">scheme</span><span class="op">:</span> <span class="st">"Dark2"</span><span class="op">,</span></span>
<span id="cb5-142"><a href="#cb5-142" aria-hidden="true" tabindex="-1"></a>        <span class="dt">legend</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb5-143"><a href="#cb5-143" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb5-144"><a href="#cb5-144" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> {</span>
<span id="cb5-145"><a href="#cb5-145" aria-hidden="true" tabindex="-1"></a>        <span class="dt">ticks</span><span class="op">:</span> <span class="dv">12</span><span class="op">,</span></span>
<span id="cb5-146"><a href="#cb5-146" aria-hidden="true" tabindex="-1"></a>        <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb5-147"><a href="#cb5-147" aria-hidden="true" tabindex="-1"></a>        <span class="dt">label</span><span class="op">:</span> <span class="st">"Months"</span><span class="op">,</span></span>
<span id="cb5-148"><a href="#cb5-148" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> <span class="st">"time"</span><span class="op">,</span></span>
<span id="cb5-149"><a href="#cb5-149" aria-hidden="true" tabindex="-1"></a>        <span class="dt">tickFormat</span><span class="op">:</span> <span class="st">"%B"</span><span class="op">,</span></span>
<span id="cb5-150"><a href="#cb5-150" aria-hidden="true" tabindex="-1"></a>        <span class="dt">domain</span><span class="op">:</span> [<span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2022</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span>)<span class="op">,</span><span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2022</span><span class="op">,</span><span class="dv">11</span><span class="op">,</span><span class="dv">31</span>)]</span>
<span id="cb5-151"><a href="#cb5-151" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb5-152"><a href="#cb5-152" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb5-153"><a href="#cb5-153" aria-hidden="true" tabindex="-1"></a>        <span class="dt">label</span><span class="op">:</span> <span class="st">"Consumption (kwhs)"</span><span class="op">,</span></span>
<span id="cb5-154"><a href="#cb5-154" aria-hidden="true" tabindex="-1"></a>        <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb5-155"><a href="#cb5-155" aria-hidden="true" tabindex="-1"></a>        <span class="dt">domain</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">40</span>]</span>
<span id="cb5-156"><a href="#cb5-156" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb5-157"><a href="#cb5-157" aria-hidden="true" tabindex="-1"></a>    <span class="dt">caption</span><span class="op">:</span> <span class="fu">html</span><span class="vs">`Figure 3. Household electricity consumption (kilowatt hours) -- A mess`</span><span class="op">,</span></span>
<span id="cb5-158"><a href="#cb5-158" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb5-159"><a href="#cb5-159" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">line</span>(days<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span> <span class="op">==</span> <span class="dv">2018</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"fakedate"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"kwhs"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">2</span>})<span class="op">,</span></span>
<span id="cb5-160"><a href="#cb5-160" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">line</span>(days<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span> <span class="op">==</span> <span class="dv">2019</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"fakedate"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"kwhs"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">2</span>})<span class="op">,</span></span>
<span id="cb5-161"><a href="#cb5-161" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">line</span>(days<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span> <span class="op">==</span> <span class="dv">2020</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"fakedate"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"kwhs"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">2</span>})<span class="op">,</span></span>
<span id="cb5-162"><a href="#cb5-162" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">line</span>(days<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span> <span class="op">==</span> <span class="dv">2021</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"fakedate"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"kwhs"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">2</span>})<span class="op">,</span></span>
<span id="cb5-163"><a href="#cb5-163" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">line</span>(days<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">year</span> <span class="op">==</span> <span class="dv">2022</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"fakedate"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"kwhs"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">2</span>})</span>
<span id="cb5-164"><a href="#cb5-164" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb5-165"><a href="#cb5-165" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-5" data-nodetype="expression">

</div>
</div>
</div>
<p><strong>What a mess!</strong> Let’s see what we can do</p>


</section>

</main> <!-- /main -->
<script type="ojs-module-contents">
{"contents":[{"methodName":"interpret","cellName":"ojs-cell-1","inline":false,"source":"// Loading our data file\nmonths = FileAttachment(\"/public/data/el-consumption-months-all.csv\").csv({typed:true}).then(raw => {\n    //We want to simplify our objects and translate the values into appropriate formats.\n    //We keep the date and the value\n    raw = raw.filter(o => {\n        var str = o[\"Fra_dato\"].substring(6,10)\n        return o[\"Type\"] === \"Tidsserie\" && str != \"2017\"\n    })\n    raw = raw.map(o => {\n            var d_str = o[\"Fra_dato\"].replace(\" 00:00:00\", \"\").split(\"-\")\n            var d = new Date(d_str[2],parseInt(d_str[1])-1)\n            var v = typeof o[\"Mængde\"] == \"string\" ? parseInt(o[\"Mængde\"]) : o[\"Mængde\"]\n            // We add a couple of things. The fakedate allow us to place all the values in the same year (to wrangle )\n            return {date: d, kwhs: parseInt(o[\"Mængde\"]), year: d.getFullYear(), month:d.getMonth(), fakedate: new Date(2022,d.getMonth())}\n    })\n\n    return raw.sort((a,b) => {\n        return a[\"date\"] > b[\"date\"]\n    })\n})\n"},{"methodName":"interpret","cellName":"ojs-cell-2","inline":false,"source":"\nPlot.plot({\n    width:860,\n    height:400,\n    marginLeft: 50,\n    legend: true,\n    x: {\n        ticks: 20,\n        grid: true,\n        label: \"Months\",\n        domain: [months[0][\"date\"],months[months.length-1][\"date\"]]\n    },\n    y: {\n        label: \"Consumption (kwhs)\",\n        grid: true,\n        domain: [200, 550]\n    },\n    caption: html`Figure 1. Household electricity consumption (kilowatt hours) from 2018 to 2022`,\n    marks: [\n        Plot.line(months, {x: \"date\", y: \"kwhs\", stroke: \"darkblue\", strokeWidth: 1, curve: \"natural\"}),\n    ]\n})\n"},{"methodName":"interpret","cellName":"ojs-cell-3","inline":false,"source":"\nPlot.plot({\n    width:860,\n    height:400,\n    marginLeft: 50,\n    color: {\n        type: \"categorical\",\n        scheme: \"Dark2\",\n        legend: true\n    },\n    x: {\n        ticks: 12,\n        grid: true,\n        label: \"Months\",\n        type: \"time\",\n        tickFormat: \"%B\",\n        domain: [new Date(2022,0,1),new Date(2022,11,1)]\n    },\n    y: {\n        label: \"Consumption (kwhs)\",\n        grid: true,\n        domain: [200, 550]\n    },\n    caption: html`Figure 2. Household electricity consumption (kilowatt hours) with line for each year.`,\n    marks: [\n        Plot.line(months, {filter: d => d.year == 2018, x: \"fakedate\", y: \"kwhs\", stroke: \"year\", strokeWidth: 2, curve: \"natural\"}),\n        Plot.line(months, {filter: d => d.year == 2019, x: \"fakedate\", y: \"kwhs\", stroke: \"year\", strokeWidth: 2, curve: \"natural\"}),\n        Plot.line(months, {filter: d => d.year == 2020, x: \"fakedate\", y: \"kwhs\", stroke: \"year\", strokeWidth: 2, curve: \"natural\"}),\n        Plot.line(months, {filter: d => d.year == 2021, x: \"fakedate\", y: \"kwhs\", stroke: \"year\", strokeWidth: 2, curve: \"natural\"}),\n        Plot.line(months, {filter: d => d.year == 2022, x: \"fakedate\", y: \"kwhs\", stroke: \"year\", strokeWidth: 2, curve: \"natural\"})\n    ]\n})\n"},{"methodName":"interpret","cellName":"ojs-cell-4","inline":false,"source":"// Loading our data file\ndays = FileAttachment(\"/public/data/el-consumption-days-all.csv\").csv({typed:true}).then(raw => {\n    //We want to simplify our objects and translate the values into appropriate formats.\n    //We keep the date and the value\n    raw = raw.filter(o => {\n        var str = o[\"Fra_dato\"].substring(6,10)\n        return o[\"Type\"] === \"Tidsserie\" && str != \"2017\"\n    })\n\n    raw = raw.map(o => {\n            var d_str = o[\"Fra_dato\"].replace(\" 00:00:00\", \"\").split(\"-\")\n            var d = new Date(d_str[2],parseInt(d_str[1])-1, d_str[0])\n            var f = new Date(2022,parseInt(d_str[1])-1, d_str[0])\n            var v = typeof o[\"Mængde\"] == \"string\" ? parseInt(o[\"Mængde\"]) : o[\"Mængde\"]\n            // We add a couple of things. The fakedate allow us to place all the values in the same year (to wrangle )\n            return {date: d, kwhs: parseInt(o[\"Mængde\"]), year: d.getFullYear(), month:d.getMonth(), fakedate: f}\n    })\n\n    return raw.sort((a,b) => {\n        return a[\"date\"] > b[\"date\"]\n    })\n})\n"},{"methodName":"interpret","cellName":"ojs-cell-5","inline":false,"source":"Plot.plot({\n    width:860,\n    height:400,\n    marginLeft: 50,\n    color: {\n        type: \"categorical\",\n        scheme: \"Dark2\",\n        legend: true\n    },\n    x: {\n        ticks: 12,\n        grid: true,\n        label: \"Months\",\n        type: \"time\",\n        tickFormat: \"%B\",\n        domain: [new Date(2022,0,1),new Date(2022,11,31)]\n    },\n    y: {\n        label: \"Consumption (kwhs)\",\n        grid: true,\n        domain: [0, 40]\n    },\n    caption: html`Figure 3. Household electricity consumption (kilowatt hours) -- A mess`,\n    marks: [\n        Plot.line(days, {filter: d => d.year == 2018, x: \"fakedate\", y: \"kwhs\", stroke: \"year\", strokeWidth: 2}),\n        Plot.line(days, {filter: d => d.year == 2019, x: \"fakedate\", y: \"kwhs\", stroke: \"year\", strokeWidth: 2}),\n        Plot.line(days, {filter: d => d.year == 2020, x: \"fakedate\", y: \"kwhs\", stroke: \"year\", strokeWidth: 2}),\n        Plot.line(days, {filter: d => d.year == 2021, x: \"fakedate\", y: \"kwhs\", stroke: \"year\", strokeWidth: 2}),\n        Plot.line(days, {filter: d => d.year == 2022, x: \"fakedate\", y: \"kwhs\", stroke: \"year\", strokeWidth: 2})\n    ]\n})\n"}]}
</script>
<script type="module">
window._ojs.paths.runtimeToDoc = "../../notes";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">
        <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://hci.social/web/@heenrik">
      <i class="bi bi-mastodon" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:korsgaard@protonmail.com?Subject=I%20saw%20your%20website...">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/henrikkorsgaard">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
      </div>
  </div>
</footer>



</body></html>